!function(){function r(e){if(e.length<=1)return null;for(var t=[],n=1;n<e.length;n++)t.push(e[n]);return t}function o(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r]);for(;n.length<t;)n.push(void 0);return n}function i(e){if(!e.modules["async-powerpack"]){if(!e.modules.async)throw Error('Missing essential components, please initialize "jscex-async" module first.');var t=e.Async,f=t.Task,c=t.CanceledError;t.sleep=function(r,i){return f.create(function(e){var t,n;i&&i.isCancellationRequested&&e.complete("failure",new c),i&&(n=function(){clearTimeout(t),e.complete("failure",new c)}),t=setTimeout(function(){i&&i.unregister(n),e.complete("success")},r),i&&i.register(n)})},t.onEvent=function(i,s,o){return f.create(function(t){o&&o.isCancellationRequested&&t.complete("failure",new c);function n(){i.removeEventListener?i.removeEventListener(s,e):i.removeListener?i.removeListener(s,e):i.detachEvent(s,e)}var e,r;o&&(r=function(){n(),t.complete("failure",new c)}),e=function(e){o&&o.unregister(r),n(),t.complete("success",e)},i.addEventListener?i.addEventListener(s,e):i.addListener?i.addListener(s,e):i.attachEvent(s,e),o&&o.register(r)})},f.whenAll=function(){var u={};if(1==arguments.length)var e=arguments[0],a=f.isTask(e)?(u[0]=e,!0):(u=e,"[object Array]"===Object.prototype.toString.call(u));else{for(e=0;e<arguments.length;e++)u[e]=arguments[e];a=!0}return f.create(function(n){var e,t,r,i={};for(e in u)u.hasOwnProperty(e)&&(t=u[e],f.isTask(t)&&(i[t.id]=e));for(r in i)t=u[i[r]],"ready"==t.status&&t.start();for(r in i)if(t=u[i[r]],t.error)return void n.complete("failure",t.error);var s=a?[]:{},o=function(e){if(e.error){for(var t in i)u[i[t]].removeEventListener("complete",o);n.complete("failure",e.error)}else s[i[e.id]]=e.result,delete i[e.id],0==--c&&n.complete("success",s)},c=0;for(r in i)e=i[r],t=u[e],"succeeded"==t.status?(s[e]=t.result,delete i[t.id]):(c++,t.addEventListener("complete",o));0==c&&n.complete("success",s)})},f.whenAny=function(){var o={};if(1==arguments.length){var e=arguments[0];f.isTask(e)?o[0]=e:o=e}else for(e=0;e<arguments.length;e++)o[e]=arguments[e];return f.create(function(n){var e,t,r,i={};for(e in o)o.hasOwnProperty(e)&&(t=o[e],f.isTask(t)&&(i[t.id]=e));for(r in i)t=o[i[r]],"ready"==t.status&&t.start();for(r in i)if(e=i[r],t=o[e],t.error||"succeeded"==t.status)return void n.complete("success",{key:e,task:t});var s=function(e){for(var t in i)o[i[t]].removeEventListener("complete",s);n.complete("success",{key:i[e.id],task:e})};for(r in i)o[i[r]].addEventListener("complete",s)})},t.Jscexify||(t.Jscexify={}),(t=t.Jscexify).fromStandard=function(n){var s=r(arguments);return function(){var e=this,t=o(arguments,n.length-1);return f.create(function(i){t.push(function(e,t){if(e)i.complete("failure",e);else{if(s){for(var n={},r=0;r<s.length;r++)n[s[r]]=arguments[r+1];return i.complete("success",n)}i.complete("success",t)}}),n.apply(e,t)})}},t.fromCallback=function(n){var i=r(arguments);return function(){var e=this,t=o(arguments,n.length-1);return f.create(function(r){t.push(function(e){if(i){for(var t={},n=0;n<i.length;n++)t[i[n]]=arguments[n];r.complete("success",t)}else r.complete("success",e)}),n.apply(e,t)})}},e.modules["async-powerpack"]=!0}}var e="function"==typeof define&&!define.amd,t="function"==typeof require&&"function"==typeof define&&define.amd;if("function"==typeof require&&"undefined"!=typeof module&&module.exports)module.exports.init=i;else if(e)define("jscex-async-powerpack",["jscex-async"],function(e,t,n){n.exports.init=i});else if(t)define("jscex-async-powerpack",["jscex-async"],function(){return{init:i}});else{if("undefined"==typeof Jscex)throw Error('Missing the root object, please load "jscex" module first.');i(Jscex)}}();