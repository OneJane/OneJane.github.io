<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="动静态分析之去弹窗重打包"><meta name="keywords" content="frida,objection"><meta name="author" content="J"><meta name="copyright" content="J"><title>动静态分析之去弹窗重打包 | 万物皆可逆向</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?a345f534c85363668f09d4d5c6a9ee81";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script",0,"ga"),ga("create","UA-111479568-4","auto"),ga("send","pageview")</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer="defer"></script><script>var GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容:${query}"}},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},hexoVersion:"4.2.1"}</script><meta name="generator" content="Hexo 4.2.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#篇幅有限"><span class="toc-number">1.</span> <span class="toc-text">篇幅有限</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#重打包"><span class="toc-number">2.</span> <span class="toc-text">重打包</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#脱壳"><span class="toc-number">3.</span> <span class="toc-text">脱壳</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#无壳去更新重打包"><span class="toc-number">4.</span> <span class="toc-text">无壳去更新重打包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#环境"><span class="toc-number">4.1.</span> <span class="toc-text">环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分析"><span class="toc-number">4.2.</span> <span class="toc-text">分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#去弹窗"><span class="toc-number">4.3.</span> <span class="toc-text">去弹窗</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#加壳去更新重打包"><span class="toc-number">5.</span> <span class="toc-text">加壳去更新重打包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#环境-1"><span class="toc-number">5.1.</span> <span class="toc-text">环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#脱壳-1"><span class="toc-number">5.2.</span> <span class="toc-text">脱壳</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#越权"><span class="toc-number">5.3.</span> <span class="toc-text">越权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#弹窗分析"><span class="toc-number">5.4.</span> <span class="toc-text">弹窗分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Window"><span class="toc-number">5.4.1.</span> <span class="toc-text">Window</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dialog"><span class="toc-number">5.4.2.</span> <span class="toc-text">Dialog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PopupWindow-amp-AlertDialog"><span class="toc-number">5.4.3.</span> <span class="toc-text">PopupWindow&amp;AlertDialog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#去壳"><span class="toc-number">5.4.4.</span> <span class="toc-text">去壳</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#去弹窗-1"><span class="toc-number">5.4.5.</span> <span class="toc-text">去弹窗</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="http://onejane.gitee.io/picture/avatar.jpg"></div><div class="author-info__name text-center">J</div><div class="author-info__description text-center">逆向,爬虫</div><div class="follow-button"><a href="https://github.com/OneJane/" target="_blank" rel="noopener">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">84</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">66</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">9</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友情链接</div><a class="author-info-links__name text-center" href="https://blog.csdn.net/welggy" target="_blank" rel="noopener">OneJane</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image:url(http://onejane.gitee.io/picture/kali.jpg)"><div id="page-header"> <span class="pull-left"><a id="site-name" href="/">万物皆可逆向</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i> <span class="pull-right menus"><a class="site-page" href="/">主页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i> <span>搜索</span></a></span></div><div id="post-info"><div id="post-title">动静态分析之去弹窗重打包</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-02-09</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/">安卓逆向</a><div class="post-meta-wordcount"><span>字数总计:</span> <span class="word-count">2.5k</span><span class="post-meta__separator">|</span><span>阅读时长: 12 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><div id="vip-container"><h1 id="篇幅有限"><a href="#篇幅有限" class="headerlink" title="篇幅有限"></a>篇幅有限</h1><p>完整内容及源码关注公众号：ReverseCode，发送 <strong>冲</strong></p><h1 id="重打包"><a href="#重打包" class="headerlink" title="重打包"></a>重打包</h1><p>带壳应用重打包失败，需要先脱壳</p><p>objection的patchapk需要aapt、adb、jarsigner、apktool，其中apktool需要官网下载下，其他前仨在android-studio中就有，注意AndroidStudio版本号：</p><p><code>tree -NCfhl|grep aapt</code> 全局搜索aapt</p><p><code>tree -NCfhl|grep jarsigner</code> 全局搜索 jarsigner</p><p><a href="https://ibotpeaches.github.io/Apktool/install/" target="_blank" rel="noopener"><strong>apktool</strong></a>下载jar和编译文件后<code>mv apktool* /usr/local/bin &amp;&amp; chmod 777 /usr/local/bin/apktool*</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ln -s /root/Desktop/android-studio/jre/bin/jarsigner /usr/bin</span><br><span class="line">ln -s /root/Android/Sdk/build-tools/30.0.3/aapt /usr/bin</span><br><span class="line">ln -s /root/Android/Sdk/build-tools/30.0.3/aapt2 /usr/bin</span><br><span class="line">ln -s /root/Android/Sdk/platform-tools/adb /usr/bin </span><br><span class="line">ln -s /root/Android/Sdk/build-tools/30.0.3/zipalign /usr/bin</span><br></pre></td></tr></table></figure><p>获取到重打包Fulao2_2021-02-09.objection.apk，卸载fulao2后重新安装<code>adb install -r Fulao2_2021-02-09.objection.apk</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pyenv local 3.8.5</span><br><span class="line">apt install aapt zipalign</span><br><span class="line">proxychains objection patchapk --architecture armeabi-v7a --source Fulao2_2021-02-09.apk</span><br></pre></td></tr></table></figure><blockquote><p>虚拟机中没有native层无法安装</p></blockquote><p><strong>内存信息搜索与执行</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /data/local/tmp &amp;&amp; ./fs1428arm64  启动frida server</span><br><span class="line">objection -g com.ilulutv.fulao2 explore</span><br><span class="line">memory list modules  查看app加载的so模块</span><br><span class="line">memory list exports libcipher-lib.so --json /root/Desktop/fulao.libcipher.json 导出库所有函数</span><br><span class="line">android heap search instances android.graphics.Bitmap   获取内存中图片对象</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/%E8%8E%B7%E5%8F%96%E5%86%85%E5%AD%98%E4%B8%AD%E5%9B%BE%E7%89%87%E5%AF%B9%E8%B1%A1.png" alt="获取内存中图片对象"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">android heap execute 257601546 getHeight --return-string  数字串是HashCode,获取图片高度</span><br><span class="line">android heap execute 257601546 getWidth --return-string  </span><br><span class="line">android heap evaluate 257601546    打印带参数的方法返回值</span><br><span class="line">console.log(clazz.getPixel(10,20))  在控制台中输入js脚本，调用有参函数</span><br></pre></td></tr></table></figure><p><strong>启动<code>activity</code>或<code>service</code></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">android hooking list activities  查看当前可用的activities</span><br><span class="line">android intent launch_activity com.ilulutv.fulao2.me.news.NewsActivity   启动指定Activity</span><br><span class="line">android hooking list receivers   查看当前可用广播</span><br><span class="line">android hooking list services  </span><br><span class="line">android hooking watch class android.graphics.Bitmap hook图片所有方法</span><br><span class="line">jobs list  查看hook了116个函数,ID为oj90asdc</span><br><span class="line">jobs kill oj90asdc  取消hook</span><br><span class="line">android hooking watch class_method android.graphics.Bitmap.nativeRowBytes --dump-args --dump-backtrace --dump-return  hook指定方法</span><br><span class="line">android hooking watch class android.graphics.BitmapFactory   hook图片所有函数</span><br><span class="line">android hooking watch class_method android.graphics.BitmapFactory.decodeByteArray --dump-args --dump-backtrace --dump-return 直接得到图片数据流</span><br><span class="line">android hooking watch class_method android.graphics.BitmapFactory.decodeByteArray --dump-backtrace  获取显示图片前解密的函数，去jadx中查看该方法逻辑</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/%E8%A7%A3%E5%AF%86%E5%87%BD%E6%95%B0.png" alt="trace中获取解密函数"></p><p>objection自带集成<a href="https://github.com/sensepost/objection/blob/master/agent/src/rpc/android.ts" target="_blank" rel="noopener">flask api</a>，可以通过rpc跑预置的命令，也可以自己传脚本到手机上跑</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">objection -g com.ilulutv.fulao2 explore --enable-api</span><br><span class="line">curl -s "http://127.0.0.1:8888/rpc/invoke/androidFileCwd"</span><br><span class="line">curl -s "http://127.0.0.1:8888/rpc/invoke/androidHookingListActivities"</span><br><span class="line">curl -s "http://127.0.0.1:8888/rpc/invoke/androidHookingGetClasses" </span><br><span class="line">url -s -X POST "http://127.0.0.1:8888/rpc/invoke/androidHookingGetClassMethods" -H "Content-Type: application/json" -d '&#123;"clazz": "android.graphics.BitmapFactory"&#125;'  </span><br><span class="line">curl -s -X POST "http://127.0.0.1:8888/rpc/invoke/androidHookingWatchClass" -H "Content-Type: application/json" -d '&#123;"clazz": "android.graphics.BitmapFactory"&#125;'   启动hook BitmapFactory，job lisk可以查看hook</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/frida&flask.png" alt="frida&amp;flask"></p><h1 id="脱壳"><a href="#脱壳" class="headerlink" title="脱壳"></a>脱壳</h1><p>objection patchapk –architecture arm64-v8a –source movetv.apk 重打包出错，加壳(腾讯)应用无法objection patchapk</p><p><del>objection -g com.cz.babySister explore -P ~/.objection/plugins/dexdump/frida_dexdump</del></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pyenv local 3.8.5</span><br><span class="line">proxychains git clone https://github.com/hluwa/FRIDA-DEXDump ~/Downloads/FRIDA-DEXDump</span><br><span class="line">mv ~/Downloads/FRIDA-DEXDump/frida_dexdump ~/.objection/plugins/dexdump</span><br><span class="line">adb install movetv.apk</span><br><span class="line">objection -g com.cz.babySister explore -P ~/.objection/plugins   加载全部插件启动app多运行一会</span><br><span class="line">plugin dexdump dump  脱壳</span><br><span class="line">cd com.cz.babySister/</span><br><span class="line">grep -ril "MainActivity" *    查看主入口dex</span><br><span class="line">objection -g com.cz.babySister explore</span><br><span class="line">android hooking list activities</span><br><span class="line">android intent launch_activity com.cz.babySister.activity.MainActivity  不登录进Activity，判断是否越权bug</span><br></pre></td></tr></table></figure><h1 id="无壳去更新重打包"><a href="#无壳去更新重打包" class="headerlink" title="无壳去更新重打包"></a>无壳去更新重打包</h1><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>/root/Android/Sdk/build-tools/30.0.3/d8 MainActivity 直接生成dex文件，老版的是d8-&gt;dx</p><p>adb install zhibo.apk 安装apk,启动新版本更新弹窗</p><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pyenv local 3.8.5</span><br><span class="line">cd /data/local/tmp/ &amp;&amp; ./fs1428arm64</span><br><span class="line">objection -g com.hd.zhibo explore</span><br><span class="line">android hooking list activities  只有一个主界面com.zhibo.media.channel_main，在AndroidManifest.xml中只有一个activity</span><br><span class="line">android heap search instances android.app.AlertDialog  获取弹窗实例hashcode,在弹窗出现前hook</span><br><span class="line">plugin load /root/.objection/plugins/Wallbreaker</span><br><span class="line">plugin wallbreaker objectsearch android.app.AlertDialog  找到实例的地址</span><br><span class="line">plugin wallbreaker objectdump 0x2956 打印类结构，其中AlertController 指向地址是0x2b26</span><br><span class="line">plugin wallbreaker objectdump 0x2b26  拿出该类中的具体信息</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/%E6%89%93%E5%8D%B0%E7%B1%BB%E7%BB%93%E6%9E%84.png" alt="打印类结构"></p><p>重新hook 类AlertDialog，并打印出调用栈</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">adb shell</span><br><span class="line">ps -e| grep zhibo   </span><br><span class="line">kill 18149    干掉进程</span><br><span class="line">objection -g com.hd.zhibo explore   启动超级直播</span><br><span class="line">android hooking watch class android.app.AlertDialog  在弹窗弹出之前开始hook</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/hook%E5%BC%B9%E7%AA%97.png" alt="hook弹窗"></p><p><code>android hooking watch class_method android.app.AlertDialog.onCreate --dump-args --dump-backtrace --dump-return</code> 再次在弹窗弹出前hook OnCreate方法</p><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/hook%E5%BC%B9%E7%AA%97Oncreate.png" alt="hook弹窗Oncreate"></p><p>通过jadx搜索<code>com.zhibo.media.channel_receiver.onReceive</code>和<code>com.zhibo.media.channel_main.update_show</code>定位到核心弹窗判断逻辑</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update_show</span><span class="params">(Bundle bundle)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (bundle != <span class="keyword">null</span> &amp;&amp; bundle.containsKey(<span class="string">"ver"</span>) &amp;&amp; bundle.containsKey(<span class="string">"info"</span>) &amp;&amp; bundle.containsKey(<span class="string">"path"</span>)) &#123;</span><br><span class="line">        <span class="keyword">new</span> AlertDialog.Builder(<span class="keyword">this</span>).setTitle(<span class="string">"发现新版本 "</span> + bundle.getString(<span class="string">"ver"</span>) + <span class="string">" 是否升级"</span>).setMessage(bundle.getString(<span class="string">"info"</span>)).setPositiveButton(<span class="string">"立刻升级"</span>, <span class="keyword">new</span> o(<span class="keyword">this</span>, bundle)).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>或者<code>objection -g com.hd.zhibo explore --startup-command &quot;android hooking watch class_method android.app.AlertDialog.onCreate --dump-args --dump-backtrace --dump-return&quot;</code> 启动时则运行命令即可避免在弹窗前跟不上执行hook</p><h2 id="去弹窗"><a href="#去弹窗" class="headerlink" title="去弹窗"></a>去弹窗</h2><p>apktool d zhibo.apk &amp;&amp; vim zhibo/smali/com/zhibo/media/channel_main.smali 解包并搜索info，修改if-eqz改为if-nez</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">apktool b zhibo/  重打包</span><br><span class="line">cd zhibo/dist &amp;&amp;  keytool -genkey -alias abc.keystore -keyalg RSA -validity 20000 -keystore abc.keystore</span><br><span class="line">Is CN=Unknown, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknown correct?</span><br><span class="line">  [no]:  yes</span><br><span class="line">jarsigner -verbose -keystore abc.keystore -signedjar textx.apk zhibo.apk abc.keystore</span><br><span class="line">pm uninstall com.hd.zhibo   卸载包</span><br><span class="line">adb install textx.apk    安装包</span><br><span class="line">am start-activity com.hd.zhibo   启动包</span><br></pre></td></tr></table></figure><h1 id="加壳去更新重打包"><a href="#加壳去更新重打包" class="headerlink" title="加壳去更新重打包"></a>加壳去更新重打包</h1><p>adb install 青青草视频.apk 启动弹窗是强制升级</p><p>jadx打开包,com.SecShell.SecShell 梆梆加固</p><h2 id="环境-1"><a href="#环境-1" class="headerlink" title="环境"></a>环境</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pyenv local 3.8.0 &amp;&amp; ./data/local/tmp/fs128arm64</span><br><span class="line">top 查看进程最高是com.hello.qqc</span><br><span class="line">┌──(root💀kali)-[~/Desktop]</span><br><span class="line">└─# frida-ps -U|grep hello                  双线程                                                                                                                                      </span><br><span class="line">23169  com.hello.qqc</span><br><span class="line">23190  com.hello.qqc</span><br><span class="line">23247  com.hello.qqc:pushcore</span><br><span class="line">23277  com.hello.qqc:pushcore</span><br></pre></td></tr></table></figure><h2 id="脱壳-1"><a href="#脱壳-1" class="headerlink" title="脱壳"></a>脱壳</h2><ul><li>objection plugin</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">objection -g com.hello.qqc explore -P ~/.objection/plugins  加载所有插件，关闭所有qqc进程，使用objection启动hook</span><br><span class="line">plugin dexdump dump  多进程的话，用objection先占用一个，再frida dexdump</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/%E5%8F%8C%E8%BF%9B%E7%A8%8B%E8%84%B1%E5%A3%B3.png" alt="双进程脱壳"></p><ul><li>python main.py</li></ul><p>通过<code>cd ~/.objection/plugins/dexdump &amp;&amp; python main.py</code> 由于双进程，需要用objection先占住启动进程，再判断前台进程进行脱壳</p><ul><li>frida-dexdump</li></ul><p><code>pip install frida-dexdump</code> 通过直接运行frida-dexdump进行脱壳</p><h2 id="越权"><a href="#越权" class="headerlink" title="越权"></a>越权</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">android hooking list activities</span><br><span class="line">android intent launch_activity cn.net.tokyo.ccg.ui.activity.AboutActivity  进入关于我们页面，绕过弹窗，再进入其他页面发现依旧存在升级弹窗</span><br></pre></td></tr></table></figure><h2 id="弹窗分析"><a href="#弹窗分析" class="headerlink" title="弹窗分析"></a>弹窗分析</h2><p>基于objection进程动态hook弹窗</p><h3 id="Window"><a href="#Window" class="headerlink" title="Window"></a>Window</h3><p>查看类是否可以hook</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">android hooking list classes   </span><br><span class="line">cat ~&#x2F;.objection&#x2F;objection.log |grep -i window    如果有则可以hook</span><br><span class="line">objection -g com.hello.qqc explore --startup-command &quot;android hooking watch class android.view.Window&quot;    对所有该Window类进行hook</span><br></pre></td></tr></table></figure><p>点击立即升级，objection显示新增agent如下</p><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/windows%E5%BC%B9%E7%AA%97%E5%8D%87%E7%BA%A7.png" alt="windows弹窗升级"></p><h3 id="Dialog"><a href="#Dialog" class="headerlink" title="Dialog"></a>Dialog</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat ~&#x2F;.objection&#x2F;objection.log |grep -i dialog</span><br><span class="line">objection -g com.hello.qqc explore --startup-command &quot;android hooking watch class android.app.Dialog&quot;</span><br></pre></td></tr></table></figure><p>点击立即升级，objection显示新增agent如下</p><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/dialog%E5%BC%B9%E7%AA%97%E5%8D%87%E7%BA%A7.png" alt="dialog弹窗升级"></p><p>点击弹窗也有agentlog打印出调用Dialog方法</p><h3 id="PopupWindow-amp-AlertDialog"><a href="#PopupWindow-amp-AlertDialog" class="headerlink" title="PopupWindow&amp;AlertDialog"></a><strong>PopupWindow&amp;AlertDialog</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">objection -g com.hello.qqc explore --startup-command &quot;android hooking watch class android.widget.PopupWindow&quot;</span><br><span class="line">或者</span><br><span class="line">objection -g com.hello.qqc explore</span><br><span class="line">android hooking watch class android.widget.PopupWindow</span><br><span class="line">android hooking watch class android.app.AlertDialog</span><br></pre></td></tr></table></figure><p>点击立即升级发现无新agentlog新增</p><hr><p>主要可能是<strong>Dialog弹窗</strong>嫌疑最大，其中agent的log<code>(agent) [5384329357348] Called android.app.Dialog.setCancelable(boolean)</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android hooking watch class_method android.app.Dialog.setCancelable --dump-args --dump-backtrace --dump-return</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/hook%E5%BC%B9%E7%AA%97%E5%87%BA%E7%8E%B0.png" alt="hook弹窗出现"></p><p>通过jadx搜索脱壳下的dex文件cn.net.tokyo.ccg.ui.fragment.dialog.UpdateDialogFragment的onCreateDialog方法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public Dialog onCreateDialog(@Nullable Bundle bundle) &#123;</span><br><span class="line">    FragmentActivity activity &#x3D; getActivity();</span><br><span class="line">    activity.getClass();</span><br><span class="line">    Dialog dialog &#x3D; new Dialog(activity, 2131755208);</span><br><span class="line">    dialog.requestWindowFeature(1);</span><br><span class="line">    dialog.setContentView(2131427414);</span><br><span class="line">    VersionBean.Version version &#x3D; this.f2134a;</span><br><span class="line">    if (version !&#x3D; null) &#123;</span><br><span class="line">        dialog.setCanceledOnTouchOutside(!WakedResultReceiver.CONTEXT_KEY.equals(version.status));</span><br><span class="line">        dialog.setCancelable(true ^ WakedResultReceiver.CONTEXT_KEY.equals(this.f2134a.status));</span><br><span class="line">        Window window &#x3D; dialog.getWindow();</span><br><span class="line">        if (window !&#x3D; null) &#123;</span><br><span class="line">            window.setBackgroundDrawable(new ColorDrawable(0));</span><br><span class="line">            WindowManager.LayoutParams attributes &#x3D; window.getAttributes();</span><br><span class="line">            attributes.width &#x3D; -1;</span><br><span class="line">            attributes.height &#x3D; -1;</span><br><span class="line">            window.setAttributes(attributes);</span><br><span class="line">        &#125;</span><br><span class="line">        a(dialog);</span><br><span class="line">    &#125;</span><br><span class="line">    return dialog;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用了a(dialog);</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">private void a(Dialog dialog) &#123;</span><br><span class="line">    Button button &#x3D; (Button) dialog.findViewById(b.btn_force_update);</span><br><span class="line">    Button button2 &#x3D; (Button) dialog.findViewById(b.btn_update);</span><br><span class="line">    Button button3 &#x3D; (Button) dialog.findViewById(b.btn_cancel);</span><br><span class="line">    TextView textView &#x3D; (TextView) dialog.findViewById(b.tv_file_size);</span><br><span class="line">    LinearLayout linearLayout &#x3D; (LinearLayout) dialog.findViewById(b.ll_button);</span><br><span class="line">    ((TextView) dialog.findViewById(b.tv_version)).setText(String.format(Locale.getDefault(), &quot;版本号：%s&quot;, this.f2134a.version));</span><br><span class="line">    ((TextView) dialog.findViewById(b.tv_content)).setText(this.f2134a.desc);</span><br><span class="line">    if (!TextUtils.isEmpty(this.f2134a.filesize)) &#123;</span><br><span class="line">        textView.setText(String.format(Locale.getDefault(), &quot;文件大小: %s&quot;, this.f2134a.filesize));</span><br><span class="line">    &#125;</span><br><span class="line">    ImageView imageView &#x3D; (ImageView) dialog.findViewById(b.im_close);</span><br><span class="line">    if (WakedResultReceiver.CONTEXT_KEY.equals(this.f2134a.status)) &#123;</span><br><span class="line">        linearLayout.setVisibility(8);</span><br><span class="line">        button.setVisibility(0);</span><br><span class="line">        button.setOnClickListener(new f(this));</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    linearLayout.setVisibility(0);</span><br><span class="line">    button.setVisibility(8);</span><br><span class="line">    button3.setOnClickListener(new g(this));</span><br><span class="line">    imageView.setVisibility(0);</span><br><span class="line">    imageView.setOnClickListener(new d(this));</span><br><span class="line">    button2.setOnClickListener(new e(this));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>中文搜索，可能被字符串混淆加密，<a href="https://mp.weixin.qq.com/s/SRv1Oar87w1iKuDXS4oaew" target="_blank" rel="noopener">Android 字符串及字典混淆开源实现</a>,或通过wallbreak查看类结构，避免字符串加密。</p><p>plugin wallbreaker objectsearch cn.net.tokyo.ccg.ui.fragment.dialog.UpdateDialogFragment 搜索类地址</p><p>plugin wallbreaker objectdump –fullname 0x2452 打印类结构</p><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/wallbreaker%E6%9F%A5%E7%9C%8B%E7%B1%BB%E7%BB%93%E6%9E%84.png" alt="wallbreaker查看类结构"></p><p>通过点击立即升级按钮，打印调用栈如下，jadx搜索cn.net.tokyo.ccg.ui.activity.MainActivity.a</p><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/hook%E5%BC%B9%E7%AA%97%E5%8F%96%E6%B6%88.png" alt="hook弹窗取消"></p><pre><code>@Override // b.a.a.a.d.b.z
public void a(VersionBean.Version version, boolean z) {
    this.f1696a = version.url;
    if (version != null) {
        UpdateDialogFragment.b(version, z).show(getSupportFragmentManager(), UpdateDialogFragment.class.getSimpleName());
    }
}
</code></pre><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/smali%E6%BA%90%E7%A0%81.png" alt="smali源码"></p><h3 id="去壳"><a href="#去壳" class="headerlink" title="去壳"></a>去壳</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apktool -s d 青青草视频.apk &amp;&amp; cd 青青草视频&#x2F;   解包指定不反编译源码并保留dex，并扔掉壳</span><br><span class="line">cp ~&#x2F;Desktop&#x2F;com.hello.qqc&#x2F;*.dex .  将之前去壳后的dex放入解包文件夹</span><br><span class="line">thunar .  打开所在文件夹，ctrl+2以详细信息查看文件，根据大小进行重命名dex，classes.dex,classes2.dex...</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/%E9%87%8D%E5%91%BD%E5%90%8Ddex.png" alt="重命名dex"></p><p>在jadx中搜索extends Application 找到主入口文件<code>cn.net.tokyo.ccg.base.App</code>,vim AndroidManifest.xml 搜索application标签，修改<code>android:name=&quot;com.SecShell.SecShell.ApplicationWrapper&quot;</code> 为<code>android:name=&quot;cn.net.tokyo.ccg.base.App&quot;</code>修改加壳入口点为原app的入口点。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apktool b 青青草视频    回编译</span><br><span class="line">cd 青青草视频&#x2F;dist    编译完成的apk</span><br><span class="line">keytool -genkey -alias abc.keystore -keyalg RSA -validity 20000 -keystore abc.keystore</span><br><span class="line">jarsigner -verbose -keystore abc.keystore -signedjar qqc_signed.apk 青青草视频.apk abc.keystore   签名</span><br><span class="line">adb install -r qqc_signed.apk  重新安装编译后的apk，即脱壳后的重打包dex</span><br></pre></td></tr></table></figure><h3 id="去弹窗-1"><a href="#去弹窗-1" class="headerlink" title="去弹窗"></a>去弹窗</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">apktool d 青青草视频.apk</span><br><span class="line">cd 青青草视频&#x2F;</span><br><span class="line">tree -NCfhl | grep MainActivity</span><br><span class="line">vim .&#x2F;青青草视频&#x2F;smali&#x2F;cn&#x2F;net&#x2F;tokyo&#x2F;ccg&#x2F;ui&#x2F;activity&#x2F;MainActivity.smali  搜索UpdateDialogFragment</span><br><span class="line">修改if-eqz p1, :cond_0为if-nez p1, :cond_0</span><br><span class="line">apktool b 青青草视频&#x2F;   回编译</span><br><span class="line">cd 青青草视频&#x2F;dist    编译完成的apk</span><br><span class="line">keytool -genkey -alias abc.keystore -keyalg RSA -validity 20000 -keystore abc.keystore</span><br><span class="line">jarsigner -verbose -keystore abc.keystore -signedjar qqc2_signed.apk 青青草视频.apk abc.keystore   重签名</span><br><span class="line">adb install -r qqc2_signed.apk  重新安装编译后的apk</span><br></pre></td></tr></table></figure></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if(!isMobile){var btw=new BTWPlugin;btw.init({id:"vip-container",blogId:"25827-1638538754631-918",name:"万物皆可逆向",qrcode:"https://onejane.github.io/gzh.jpg",keyword:"密码"})}</script></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined">J</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="http://onejane.github.io/2021/02/09/动静态分析之去弹窗重打包/">http://onejane.github.io/2021/02/09/动静态分析之去弹窗重打包/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://onejane.github.io">万物皆可逆向</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/frida/">frida</a><a class="post-meta__tags" href="/tags/objection/">objection</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="http://onejane.gitee.io/picture/alipay.png"><div class="post-qr-code__desc">支付宝打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="http://onejane.gitee.io/picture/wx.png"><div class="post-qr-code__desc">微信打赏</div></div></div><div class="social-share pull-right" data-disabled="google,facebook"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2021/02/12/%E5%9F%BA%E4%BA%8E%E5%86%85%E5%AD%98%E6%BC%AB%E6%B8%B8%E5%AE%9A%E4%BD%8D%E5%88%86%E6%9E%90/"><i class="fa fa-chevron-left"></i> <span>基于内存漫游定位分析</span></a></div><div class="next-post pull-right"><a href="/2021/02/05/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E9%94%81%E6%9C%BA%E7%97%85%E6%AF%92/"><span>动静态分析之锁机病毒</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="vcomment"></div><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify=!1,verify=!1,record_ip=!1,GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter(function(i){return-1<GUEST_INFO.indexOf(i)});guest_info=0==guest_info.length?GUEST_INFO:guest_info,window.valine=new Valine({el:"#vcomment",notify:notify,verify:verify,recordIP:record_ip,appId:"cWLsquGr5PNi33OWXNhzerep-gzGzoHsz",appKey:"S35phfCSbm8dAG9LpOc5rjm3",placeholder:"一起来吹牛逼好吗！",avatar:"mm",guest_info:guest_info,pageSize:"10",lang:"zh-cn"})</script></div></div><footer class="footer-bg" style="background-image:url(http://onejane.gitee.io/picture/kali.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2021 - 2022 By J</div><div class="framework-info"><span>驱动 -</span> <a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 -</span> <a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script src="/js/search/local-search.js"></script><script>/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)&&($("#nav").addClass("is-mobile"),$("footer").addClass("is-mobile"),$("#top-container").addClass("is-mobile"))</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49b1f5">hexo-generator-search</a> <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>