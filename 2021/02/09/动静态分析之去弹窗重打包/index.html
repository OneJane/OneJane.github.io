<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="åŠ¨é™æ€åˆ†æä¹‹å»å¼¹çª—é‡æ‰“åŒ…"><meta name="keywords" content="frida,objection"><meta name="author" content="J"><meta name="copyright" content="J"><title>åŠ¨é™æ€åˆ†æä¹‹å»å¼¹çª—é‡æ‰“åŒ… | ä¸‡ç‰©çš†å¯é€†å‘</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?a345f534c85363668f09d4d5c6a9ee81";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script",0,"ga"),ga("create","UA-111479568-4","auto"),ga("send","pageview")</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer="defer"></script><script>var GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹:${query}"}},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},hexoVersion:"4.2.1"}</script><meta name="generator" content="Hexo 4.2.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="åˆ‡æ¢æ–‡ç« è¯¦æƒ…">åˆ‡æ¢ç«™ç‚¹æ¦‚è§ˆ</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ç¯‡å¹…æœ‰é™"><span class="toc-number">1.</span> <span class="toc-text">ç¯‡å¹…æœ‰é™</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#é‡æ‰“åŒ…"><span class="toc-number">2.</span> <span class="toc-text">é‡æ‰“åŒ…</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#è„±å£³"><span class="toc-number">3.</span> <span class="toc-text">è„±å£³</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ— å£³å»æ›´æ–°é‡æ‰“åŒ…"><span class="toc-number">4.</span> <span class="toc-text">æ— å£³å»æ›´æ–°é‡æ‰“åŒ…</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ç¯å¢ƒ"><span class="toc-number">4.1.</span> <span class="toc-text">ç¯å¢ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åˆ†æ"><span class="toc-number">4.2.</span> <span class="toc-text">åˆ†æ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å»å¼¹çª—"><span class="toc-number">4.3.</span> <span class="toc-text">å»å¼¹çª—</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åŠ å£³å»æ›´æ–°é‡æ‰“åŒ…"><span class="toc-number">5.</span> <span class="toc-text">åŠ å£³å»æ›´æ–°é‡æ‰“åŒ…</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ç¯å¢ƒ-1"><span class="toc-number">5.1.</span> <span class="toc-text">ç¯å¢ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è„±å£³-1"><span class="toc-number">5.2.</span> <span class="toc-text">è„±å£³</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è¶Šæƒ"><span class="toc-number">5.3.</span> <span class="toc-text">è¶Šæƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å¼¹çª—åˆ†æ"><span class="toc-number">5.4.</span> <span class="toc-text">å¼¹çª—åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Window"><span class="toc-number">5.4.1.</span> <span class="toc-text">Window</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dialog"><span class="toc-number">5.4.2.</span> <span class="toc-text">Dialog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PopupWindow-amp-AlertDialog"><span class="toc-number">5.4.3.</span> <span class="toc-text">PopupWindow&amp;AlertDialog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å»å£³"><span class="toc-number">5.4.4.</span> <span class="toc-text">å»å£³</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å»å¼¹çª—-1"><span class="toc-number">5.4.5.</span> <span class="toc-text">å»å¼¹çª—</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="http://onejane.gitee.io/picture/avatar.jpg"></div><div class="author-info__name text-center">J</div><div class="author-info__description text-center">é€†å‘,çˆ¬è™«</div><div class="follow-button"><a href="https://github.com/OneJane/" target="_blank" rel="noopener">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">æ–‡ç« </span><span class="pull-right">84</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">æ ‡ç­¾</span><span class="pull-right">66</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">åˆ†ç±»</span><span class="pull-right">9</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">å‹æƒ…é“¾æ¥</div><a class="author-info-links__name text-center" href="https://blog.csdn.net/welggy" target="_blank" rel="noopener">OneJane</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image:url(http://onejane.gitee.io/picture/kali.jpg)"><div id="page-header"> <span class="pull-left"><a id="site-name" href="/">ä¸‡ç‰©çš†å¯é€†å‘</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i> <span class="pull-right menus"><a class="site-page" href="/">ä¸»é¡µ</a><a class="site-page" href="/archives">å½’æ¡£</a><a class="site-page" href="/tags">æ ‡ç­¾</a><a class="site-page" href="/categories">åˆ†ç±»</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i> <span>æœç´¢</span></a></span></div><div id="post-info"><div id="post-title">åŠ¨é™æ€åˆ†æä¹‹å»å¼¹çª—é‡æ‰“åŒ…</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-02-09</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/">å®‰å“é€†å‘</a><div class="post-meta-wordcount"><span>å­—æ•°æ€»è®¡:</span> <span class="word-count">2.5k</span><span class="post-meta__separator">|</span><span>é˜…è¯»æ—¶é•¿: 12 åˆ†é’Ÿ</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><div id="vip-container"><h1 id="ç¯‡å¹…æœ‰é™"><a href="#ç¯‡å¹…æœ‰é™" class="headerlink" title="ç¯‡å¹…æœ‰é™"></a>ç¯‡å¹…æœ‰é™</h1><p>å®Œæ•´å†…å®¹åŠæºç å…³æ³¨å…¬ä¼—å·ï¼šReverseCodeï¼Œå‘é€ <strong>å†²</strong></p><h1 id="é‡æ‰“åŒ…"><a href="#é‡æ‰“åŒ…" class="headerlink" title="é‡æ‰“åŒ…"></a>é‡æ‰“åŒ…</h1><p>å¸¦å£³åº”ç”¨é‡æ‰“åŒ…å¤±è´¥ï¼Œéœ€è¦å…ˆè„±å£³</p><p>objectionçš„patchapkéœ€è¦aaptã€adbã€jarsignerã€apktoolï¼Œå…¶ä¸­apktooléœ€è¦å®˜ç½‘ä¸‹è½½ä¸‹ï¼Œå…¶ä»–å‰ä»¨åœ¨android-studioä¸­å°±æœ‰ï¼Œæ³¨æ„AndroidStudioç‰ˆæœ¬å·ï¼š</p><p><code>tree -NCfhl|grep aapt</code> å…¨å±€æœç´¢aapt</p><p><code>tree -NCfhl|grep jarsigner</code> å…¨å±€æœç´¢ jarsigner</p><p><a href="https://ibotpeaches.github.io/Apktool/install/" target="_blank" rel="noopener"><strong>apktool</strong></a>ä¸‹è½½jarå’Œç¼–è¯‘æ–‡ä»¶å<code>mv apktool* /usr/local/bin &amp;&amp; chmod 777 /usr/local/bin/apktool*</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ln -s /root/Desktop/android-studio/jre/bin/jarsigner /usr/bin</span><br><span class="line">ln -s /root/Android/Sdk/build-tools/30.0.3/aapt /usr/bin</span><br><span class="line">ln -s /root/Android/Sdk/build-tools/30.0.3/aapt2 /usr/bin</span><br><span class="line">ln -s /root/Android/Sdk/platform-tools/adb /usr/bin </span><br><span class="line">ln -s /root/Android/Sdk/build-tools/30.0.3/zipalign /usr/bin</span><br></pre></td></tr></table></figure><p>è·å–åˆ°é‡æ‰“åŒ…Fulao2_2021-02-09.objection.apkï¼Œå¸è½½fulao2åé‡æ–°å®‰è£…<code>adb install -r Fulao2_2021-02-09.objection.apk</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pyenv local 3.8.5</span><br><span class="line">apt install aapt zipalign</span><br><span class="line">proxychains objection patchapk --architecture armeabi-v7a --source Fulao2_2021-02-09.apk</span><br></pre></td></tr></table></figure><blockquote><p>è™šæ‹Ÿæœºä¸­æ²¡æœ‰nativeå±‚æ— æ³•å®‰è£…</p></blockquote><p><strong>å†…å­˜ä¿¡æ¯æœç´¢ä¸æ‰§è¡Œ</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /data/local/tmp &amp;&amp; ./fs1428arm64  å¯åŠ¨frida server</span><br><span class="line">objection -g com.ilulutv.fulao2 explore</span><br><span class="line">memory list modules  æŸ¥çœ‹appåŠ è½½çš„soæ¨¡å—</span><br><span class="line">memory list exports libcipher-lib.so --json /root/Desktop/fulao.libcipher.json å¯¼å‡ºåº“æ‰€æœ‰å‡½æ•°</span><br><span class="line">android heap search instances android.graphics.Bitmap   è·å–å†…å­˜ä¸­å›¾ç‰‡å¯¹è±¡</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/%E8%8E%B7%E5%8F%96%E5%86%85%E5%AD%98%E4%B8%AD%E5%9B%BE%E7%89%87%E5%AF%B9%E8%B1%A1.png" alt="è·å–å†…å­˜ä¸­å›¾ç‰‡å¯¹è±¡"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">android heap execute 257601546 getHeight --return-string  æ•°å­—ä¸²æ˜¯HashCode,è·å–å›¾ç‰‡é«˜åº¦</span><br><span class="line">android heap execute 257601546 getWidth --return-string  </span><br><span class="line">android heap evaluate 257601546    æ‰“å°å¸¦å‚æ•°çš„æ–¹æ³•è¿”å›å€¼</span><br><span class="line">console.log(clazz.getPixel(10,20))  åœ¨æ§åˆ¶å°ä¸­è¾“å…¥jsè„šæœ¬ï¼Œè°ƒç”¨æœ‰å‚å‡½æ•°</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨<code>activity</code>æˆ–<code>service</code></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">android hooking list activities  æŸ¥çœ‹å½“å‰å¯ç”¨çš„activities</span><br><span class="line">android intent launch_activity com.ilulutv.fulao2.me.news.NewsActivity   å¯åŠ¨æŒ‡å®šActivity</span><br><span class="line">android hooking list receivers   æŸ¥çœ‹å½“å‰å¯ç”¨å¹¿æ’­</span><br><span class="line">android hooking list services  </span><br><span class="line">android hooking watch class android.graphics.Bitmap hookå›¾ç‰‡æ‰€æœ‰æ–¹æ³•</span><br><span class="line">jobs list  æŸ¥çœ‹hookäº†116ä¸ªå‡½æ•°,IDä¸ºoj90asdc</span><br><span class="line">jobs kill oj90asdc  å–æ¶ˆhook</span><br><span class="line">android hooking watch class_method android.graphics.Bitmap.nativeRowBytes --dump-args --dump-backtrace --dump-return  hookæŒ‡å®šæ–¹æ³•</span><br><span class="line">android hooking watch class android.graphics.BitmapFactory   hookå›¾ç‰‡æ‰€æœ‰å‡½æ•°</span><br><span class="line">android hooking watch class_method android.graphics.BitmapFactory.decodeByteArray --dump-args --dump-backtrace --dump-return ç›´æ¥å¾—åˆ°å›¾ç‰‡æ•°æ®æµ</span><br><span class="line">android hooking watch class_method android.graphics.BitmapFactory.decodeByteArray --dump-backtrace  è·å–æ˜¾ç¤ºå›¾ç‰‡å‰è§£å¯†çš„å‡½æ•°ï¼Œå»jadxä¸­æŸ¥çœ‹è¯¥æ–¹æ³•é€»è¾‘</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/%E8%A7%A3%E5%AF%86%E5%87%BD%E6%95%B0.png" alt="traceä¸­è·å–è§£å¯†å‡½æ•°"></p><p>objectionè‡ªå¸¦é›†æˆ<a href="https://github.com/sensepost/objection/blob/master/agent/src/rpc/android.ts" target="_blank" rel="noopener">flask api</a>ï¼Œå¯ä»¥é€šè¿‡rpcè·‘é¢„ç½®çš„å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥è‡ªå·±ä¼ è„šæœ¬åˆ°æ‰‹æœºä¸Šè·‘</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">objection -g com.ilulutv.fulao2 explore --enable-api</span><br><span class="line">curl -s "http://127.0.0.1:8888/rpc/invoke/androidFileCwd"</span><br><span class="line">curl -s "http://127.0.0.1:8888/rpc/invoke/androidHookingListActivities"</span><br><span class="line">curl -s "http://127.0.0.1:8888/rpc/invoke/androidHookingGetClasses" </span><br><span class="line">url -s -X POST "http://127.0.0.1:8888/rpc/invoke/androidHookingGetClassMethods" -H "Content-Type: application/json" -d '&#123;"clazz": "android.graphics.BitmapFactory"&#125;'  </span><br><span class="line">curl -s -X POST "http://127.0.0.1:8888/rpc/invoke/androidHookingWatchClass" -H "Content-Type: application/json" -d '&#123;"clazz": "android.graphics.BitmapFactory"&#125;'   å¯åŠ¨hook BitmapFactoryï¼Œjob liskå¯ä»¥æŸ¥çœ‹hook</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/frida&flask.png" alt="frida&amp;flask"></p><h1 id="è„±å£³"><a href="#è„±å£³" class="headerlink" title="è„±å£³"></a>è„±å£³</h1><p>objection patchapk â€“architecture arm64-v8a â€“source movetv.apk é‡æ‰“åŒ…å‡ºé”™ï¼ŒåŠ å£³(è…¾è®¯)åº”ç”¨æ— æ³•objection patchapk</p><p><del>objection -g com.cz.babySister explore -P ~/.objection/plugins/dexdump/frida_dexdump</del></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pyenv local 3.8.5</span><br><span class="line">proxychains git clone https://github.com/hluwa/FRIDA-DEXDump ~/Downloads/FRIDA-DEXDump</span><br><span class="line">mv ~/Downloads/FRIDA-DEXDump/frida_dexdump ~/.objection/plugins/dexdump</span><br><span class="line">adb install movetv.apk</span><br><span class="line">objection -g com.cz.babySister explore -P ~/.objection/plugins   åŠ è½½å…¨éƒ¨æ’ä»¶å¯åŠ¨appå¤šè¿è¡Œä¸€ä¼š</span><br><span class="line">plugin dexdump dump  è„±å£³</span><br><span class="line">cd com.cz.babySister/</span><br><span class="line">grep -ril "MainActivity" *    æŸ¥çœ‹ä¸»å…¥å£dex</span><br><span class="line">objection -g com.cz.babySister explore</span><br><span class="line">android hooking list activities</span><br><span class="line">android intent launch_activity com.cz.babySister.activity.MainActivity  ä¸ç™»å½•è¿›Activityï¼Œåˆ¤æ–­æ˜¯å¦è¶Šæƒbug</span><br></pre></td></tr></table></figure><h1 id="æ— å£³å»æ›´æ–°é‡æ‰“åŒ…"><a href="#æ— å£³å»æ›´æ–°é‡æ‰“åŒ…" class="headerlink" title="æ— å£³å»æ›´æ–°é‡æ‰“åŒ…"></a>æ— å£³å»æ›´æ–°é‡æ‰“åŒ…</h1><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p>/root/Android/Sdk/build-tools/30.0.3/d8 MainActivity ç›´æ¥ç”Ÿæˆdexæ–‡ä»¶ï¼Œè€ç‰ˆçš„æ˜¯d8-&gt;dx</p><p>adb install zhibo.apk å®‰è£…apk,å¯åŠ¨æ–°ç‰ˆæœ¬æ›´æ–°å¼¹çª—</p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pyenv local 3.8.5</span><br><span class="line">cd /data/local/tmp/ &amp;&amp; ./fs1428arm64</span><br><span class="line">objection -g com.hd.zhibo explore</span><br><span class="line">android hooking list activities  åªæœ‰ä¸€ä¸ªä¸»ç•Œé¢com.zhibo.media.channel_mainï¼Œåœ¨AndroidManifest.xmlä¸­åªæœ‰ä¸€ä¸ªactivity</span><br><span class="line">android heap search instances android.app.AlertDialog  è·å–å¼¹çª—å®ä¾‹hashcode,åœ¨å¼¹çª—å‡ºç°å‰hook</span><br><span class="line">plugin load /root/.objection/plugins/Wallbreaker</span><br><span class="line">plugin wallbreaker objectsearch android.app.AlertDialog  æ‰¾åˆ°å®ä¾‹çš„åœ°å€</span><br><span class="line">plugin wallbreaker objectdump 0x2956 æ‰“å°ç±»ç»“æ„ï¼Œå…¶ä¸­AlertController æŒ‡å‘åœ°å€æ˜¯0x2b26</span><br><span class="line">plugin wallbreaker objectdump 0x2b26  æ‹¿å‡ºè¯¥ç±»ä¸­çš„å…·ä½“ä¿¡æ¯</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/%E6%89%93%E5%8D%B0%E7%B1%BB%E7%BB%93%E6%9E%84.png" alt="æ‰“å°ç±»ç»“æ„"></p><p>é‡æ–°hook ç±»AlertDialogï¼Œå¹¶æ‰“å°å‡ºè°ƒç”¨æ ˆ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">adb shell</span><br><span class="line">ps -e| grep zhibo   </span><br><span class="line">kill 18149    å¹²æ‰è¿›ç¨‹</span><br><span class="line">objection -g com.hd.zhibo explore   å¯åŠ¨è¶…çº§ç›´æ’­</span><br><span class="line">android hooking watch class android.app.AlertDialog  åœ¨å¼¹çª—å¼¹å‡ºä¹‹å‰å¼€å§‹hook</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/hook%E5%BC%B9%E7%AA%97.png" alt="hookå¼¹çª—"></p><p><code>android hooking watch class_method android.app.AlertDialog.onCreate --dump-args --dump-backtrace --dump-return</code> å†æ¬¡åœ¨å¼¹çª—å¼¹å‡ºå‰hook OnCreateæ–¹æ³•</p><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/hook%E5%BC%B9%E7%AA%97Oncreate.png" alt="hookå¼¹çª—Oncreate"></p><p>é€šè¿‡jadxæœç´¢<code>com.zhibo.media.channel_receiver.onReceive</code>å’Œ<code>com.zhibo.media.channel_main.update_show</code>å®šä½åˆ°æ ¸å¿ƒå¼¹çª—åˆ¤æ–­é€»è¾‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update_show</span><span class="params">(Bundle bundle)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (bundle != <span class="keyword">null</span> &amp;&amp; bundle.containsKey(<span class="string">"ver"</span>) &amp;&amp; bundle.containsKey(<span class="string">"info"</span>) &amp;&amp; bundle.containsKey(<span class="string">"path"</span>)) &#123;</span><br><span class="line">        <span class="keyword">new</span> AlertDialog.Builder(<span class="keyword">this</span>).setTitle(<span class="string">"å‘ç°æ–°ç‰ˆæœ¬ "</span> + bundle.getString(<span class="string">"ver"</span>) + <span class="string">" æ˜¯å¦å‡çº§"</span>).setMessage(bundle.getString(<span class="string">"info"</span>)).setPositiveButton(<span class="string">"ç«‹åˆ»å‡çº§"</span>, <span class="keyword">new</span> o(<span class="keyword">this</span>, bundle)).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ–è€…<code>objection -g com.hd.zhibo explore --startup-command &quot;android hooking watch class_method android.app.AlertDialog.onCreate --dump-args --dump-backtrace --dump-return&quot;</code> å¯åŠ¨æ—¶åˆ™è¿è¡Œå‘½ä»¤å³å¯é¿å…åœ¨å¼¹çª—å‰è·Ÿä¸ä¸Šæ‰§è¡Œhook</p><h2 id="å»å¼¹çª—"><a href="#å»å¼¹çª—" class="headerlink" title="å»å¼¹çª—"></a>å»å¼¹çª—</h2><p>apktool d zhibo.apk &amp;&amp; vim zhibo/smali/com/zhibo/media/channel_main.smali è§£åŒ…å¹¶æœç´¢infoï¼Œä¿®æ”¹if-eqzæ”¹ä¸ºif-nez</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">apktool b zhibo/  é‡æ‰“åŒ…</span><br><span class="line">cd zhibo/dist &amp;&amp;  keytool -genkey -alias abc.keystore -keyalg RSA -validity 20000 -keystore abc.keystore</span><br><span class="line">Is CN=Unknown, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknown correct?</span><br><span class="line">  [no]:  yes</span><br><span class="line">jarsigner -verbose -keystore abc.keystore -signedjar textx.apk zhibo.apk abc.keystore</span><br><span class="line">pm uninstall com.hd.zhibo   å¸è½½åŒ…</span><br><span class="line">adb install textx.apk    å®‰è£…åŒ…</span><br><span class="line">am start-activity com.hd.zhibo   å¯åŠ¨åŒ…</span><br></pre></td></tr></table></figure><h1 id="åŠ å£³å»æ›´æ–°é‡æ‰“åŒ…"><a href="#åŠ å£³å»æ›´æ–°é‡æ‰“åŒ…" class="headerlink" title="åŠ å£³å»æ›´æ–°é‡æ‰“åŒ…"></a>åŠ å£³å»æ›´æ–°é‡æ‰“åŒ…</h1><p>adb install é’é’è‰è§†é¢‘.apk å¯åŠ¨å¼¹çª—æ˜¯å¼ºåˆ¶å‡çº§</p><p>jadxæ‰“å¼€åŒ…,com.SecShell.SecShell æ¢†æ¢†åŠ å›º</p><h2 id="ç¯å¢ƒ-1"><a href="#ç¯å¢ƒ-1" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pyenv local 3.8.0 &amp;&amp; ./data/local/tmp/fs128arm64</span><br><span class="line">top æŸ¥çœ‹è¿›ç¨‹æœ€é«˜æ˜¯com.hello.qqc</span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]</span><br><span class="line">â””â”€# frida-ps -U|grep hello                  åŒçº¿ç¨‹                                                                                                                                      </span><br><span class="line">23169  com.hello.qqc</span><br><span class="line">23190  com.hello.qqc</span><br><span class="line">23247  com.hello.qqc:pushcore</span><br><span class="line">23277  com.hello.qqc:pushcore</span><br></pre></td></tr></table></figure><h2 id="è„±å£³-1"><a href="#è„±å£³-1" class="headerlink" title="è„±å£³"></a>è„±å£³</h2><ul><li>objection plugin</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">objection -g com.hello.qqc explore -P ~/.objection/plugins  åŠ è½½æ‰€æœ‰æ’ä»¶ï¼Œå…³é—­æ‰€æœ‰qqcè¿›ç¨‹ï¼Œä½¿ç”¨objectionå¯åŠ¨hook</span><br><span class="line">plugin dexdump dump  å¤šè¿›ç¨‹çš„è¯ï¼Œç”¨objectionå…ˆå ç”¨ä¸€ä¸ªï¼Œå†frida dexdump</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/%E5%8F%8C%E8%BF%9B%E7%A8%8B%E8%84%B1%E5%A3%B3.png" alt="åŒè¿›ç¨‹è„±å£³"></p><ul><li>python main.py</li></ul><p>é€šè¿‡<code>cd ~/.objection/plugins/dexdump &amp;&amp; python main.py</code> ç”±äºåŒè¿›ç¨‹ï¼Œéœ€è¦ç”¨objectionå…ˆå ä½å¯åŠ¨è¿›ç¨‹ï¼Œå†åˆ¤æ–­å‰å°è¿›ç¨‹è¿›è¡Œè„±å£³</p><ul><li>frida-dexdump</li></ul><p><code>pip install frida-dexdump</code> é€šè¿‡ç›´æ¥è¿è¡Œfrida-dexdumpè¿›è¡Œè„±å£³</p><h2 id="è¶Šæƒ"><a href="#è¶Šæƒ" class="headerlink" title="è¶Šæƒ"></a>è¶Šæƒ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">android hooking list activities</span><br><span class="line">android intent launch_activity cn.net.tokyo.ccg.ui.activity.AboutActivity  è¿›å…¥å…³äºæˆ‘ä»¬é¡µé¢ï¼Œç»•è¿‡å¼¹çª—ï¼Œå†è¿›å…¥å…¶ä»–é¡µé¢å‘ç°ä¾æ—§å­˜åœ¨å‡çº§å¼¹çª—</span><br></pre></td></tr></table></figure><h2 id="å¼¹çª—åˆ†æ"><a href="#å¼¹çª—åˆ†æ" class="headerlink" title="å¼¹çª—åˆ†æ"></a>å¼¹çª—åˆ†æ</h2><p>åŸºäºobjectionè¿›ç¨‹åŠ¨æ€hookå¼¹çª—</p><h3 id="Window"><a href="#Window" class="headerlink" title="Window"></a>Window</h3><p>æŸ¥çœ‹ç±»æ˜¯å¦å¯ä»¥hook</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">android hooking list classes   </span><br><span class="line">cat ~&#x2F;.objection&#x2F;objection.log |grep -i window    å¦‚æœæœ‰åˆ™å¯ä»¥hook</span><br><span class="line">objection -g com.hello.qqc explore --startup-command &quot;android hooking watch class android.view.Window&quot;    å¯¹æ‰€æœ‰è¯¥Windowç±»è¿›è¡Œhook</span><br></pre></td></tr></table></figure><p>ç‚¹å‡»ç«‹å³å‡çº§ï¼Œobjectionæ˜¾ç¤ºæ–°å¢agentå¦‚ä¸‹</p><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/windows%E5%BC%B9%E7%AA%97%E5%8D%87%E7%BA%A7.png" alt="windowså¼¹çª—å‡çº§"></p><h3 id="Dialog"><a href="#Dialog" class="headerlink" title="Dialog"></a>Dialog</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat ~&#x2F;.objection&#x2F;objection.log |grep -i dialog</span><br><span class="line">objection -g com.hello.qqc explore --startup-command &quot;android hooking watch class android.app.Dialog&quot;</span><br></pre></td></tr></table></figure><p>ç‚¹å‡»ç«‹å³å‡çº§ï¼Œobjectionæ˜¾ç¤ºæ–°å¢agentå¦‚ä¸‹</p><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/dialog%E5%BC%B9%E7%AA%97%E5%8D%87%E7%BA%A7.png" alt="dialogå¼¹çª—å‡çº§"></p><p>ç‚¹å‡»å¼¹çª—ä¹Ÿæœ‰agentlogæ‰“å°å‡ºè°ƒç”¨Dialogæ–¹æ³•</p><h3 id="PopupWindow-amp-AlertDialog"><a href="#PopupWindow-amp-AlertDialog" class="headerlink" title="PopupWindow&amp;AlertDialog"></a><strong>PopupWindow&amp;AlertDialog</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">objection -g com.hello.qqc explore --startup-command &quot;android hooking watch class android.widget.PopupWindow&quot;</span><br><span class="line">æˆ–è€…</span><br><span class="line">objection -g com.hello.qqc explore</span><br><span class="line">android hooking watch class android.widget.PopupWindow</span><br><span class="line">android hooking watch class android.app.AlertDialog</span><br></pre></td></tr></table></figure><p>ç‚¹å‡»ç«‹å³å‡çº§å‘ç°æ— æ–°agentlogæ–°å¢</p><hr><p>ä¸»è¦å¯èƒ½æ˜¯<strong>Dialogå¼¹çª—</strong>å«Œç–‘æœ€å¤§ï¼Œå…¶ä¸­agentçš„log<code>(agent) [5384329357348] Called android.app.Dialog.setCancelable(boolean)</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android hooking watch class_method android.app.Dialog.setCancelable --dump-args --dump-backtrace --dump-return</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/hook%E5%BC%B9%E7%AA%97%E5%87%BA%E7%8E%B0.png" alt="hookå¼¹çª—å‡ºç°"></p><p>é€šè¿‡jadxæœç´¢è„±å£³ä¸‹çš„dexæ–‡ä»¶cn.net.tokyo.ccg.ui.fragment.dialog.UpdateDialogFragmentçš„onCreateDialogæ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public Dialog onCreateDialog(@Nullable Bundle bundle) &#123;</span><br><span class="line">    FragmentActivity activity &#x3D; getActivity();</span><br><span class="line">    activity.getClass();</span><br><span class="line">    Dialog dialog &#x3D; new Dialog(activity, 2131755208);</span><br><span class="line">    dialog.requestWindowFeature(1);</span><br><span class="line">    dialog.setContentView(2131427414);</span><br><span class="line">    VersionBean.Version version &#x3D; this.f2134a;</span><br><span class="line">    if (version !&#x3D; null) &#123;</span><br><span class="line">        dialog.setCanceledOnTouchOutside(!WakedResultReceiver.CONTEXT_KEY.equals(version.status));</span><br><span class="line">        dialog.setCancelable(true ^ WakedResultReceiver.CONTEXT_KEY.equals(this.f2134a.status));</span><br><span class="line">        Window window &#x3D; dialog.getWindow();</span><br><span class="line">        if (window !&#x3D; null) &#123;</span><br><span class="line">            window.setBackgroundDrawable(new ColorDrawable(0));</span><br><span class="line">            WindowManager.LayoutParams attributes &#x3D; window.getAttributes();</span><br><span class="line">            attributes.width &#x3D; -1;</span><br><span class="line">            attributes.height &#x3D; -1;</span><br><span class="line">            window.setAttributes(attributes);</span><br><span class="line">        &#125;</span><br><span class="line">        a(dialog);</span><br><span class="line">    &#125;</span><br><span class="line">    return dialog;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨äº†a(dialog);</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">private void a(Dialog dialog) &#123;</span><br><span class="line">    Button button &#x3D; (Button) dialog.findViewById(b.btn_force_update);</span><br><span class="line">    Button button2 &#x3D; (Button) dialog.findViewById(b.btn_update);</span><br><span class="line">    Button button3 &#x3D; (Button) dialog.findViewById(b.btn_cancel);</span><br><span class="line">    TextView textView &#x3D; (TextView) dialog.findViewById(b.tv_file_size);</span><br><span class="line">    LinearLayout linearLayout &#x3D; (LinearLayout) dialog.findViewById(b.ll_button);</span><br><span class="line">    ((TextView) dialog.findViewById(b.tv_version)).setText(String.format(Locale.getDefault(), &quot;ç‰ˆæœ¬å·ï¼š%s&quot;, this.f2134a.version));</span><br><span class="line">    ((TextView) dialog.findViewById(b.tv_content)).setText(this.f2134a.desc);</span><br><span class="line">    if (!TextUtils.isEmpty(this.f2134a.filesize)) &#123;</span><br><span class="line">        textView.setText(String.format(Locale.getDefault(), &quot;æ–‡ä»¶å¤§å°: %s&quot;, this.f2134a.filesize));</span><br><span class="line">    &#125;</span><br><span class="line">    ImageView imageView &#x3D; (ImageView) dialog.findViewById(b.im_close);</span><br><span class="line">    if (WakedResultReceiver.CONTEXT_KEY.equals(this.f2134a.status)) &#123;</span><br><span class="line">        linearLayout.setVisibility(8);</span><br><span class="line">        button.setVisibility(0);</span><br><span class="line">        button.setOnClickListener(new f(this));</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    linearLayout.setVisibility(0);</span><br><span class="line">    button.setVisibility(8);</span><br><span class="line">    button3.setOnClickListener(new g(this));</span><br><span class="line">    imageView.setVisibility(0);</span><br><span class="line">    imageView.setOnClickListener(new d(this));</span><br><span class="line">    button2.setOnClickListener(new e(this));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸­æ–‡æœç´¢ï¼Œå¯èƒ½è¢«å­—ç¬¦ä¸²æ··æ·†åŠ å¯†ï¼Œ<a href="https://mp.weixin.qq.com/s/SRv1Oar87w1iKuDXS4oaew" target="_blank" rel="noopener">Android å­—ç¬¦ä¸²åŠå­—å…¸æ··æ·†å¼€æºå®ç°</a>,æˆ–é€šè¿‡wallbreakæŸ¥çœ‹ç±»ç»“æ„ï¼Œé¿å…å­—ç¬¦ä¸²åŠ å¯†ã€‚</p><p>plugin wallbreaker objectsearch cn.net.tokyo.ccg.ui.fragment.dialog.UpdateDialogFragment æœç´¢ç±»åœ°å€</p><p>plugin wallbreaker objectdump â€“fullname 0x2452 æ‰“å°ç±»ç»“æ„</p><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/wallbreaker%E6%9F%A5%E7%9C%8B%E7%B1%BB%E7%BB%93%E6%9E%84.png" alt="wallbreakeræŸ¥çœ‹ç±»ç»“æ„"></p><p>é€šè¿‡ç‚¹å‡»ç«‹å³å‡çº§æŒ‰é’®ï¼Œæ‰“å°è°ƒç”¨æ ˆå¦‚ä¸‹ï¼Œjadxæœç´¢cn.net.tokyo.ccg.ui.activity.MainActivity.a</p><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/hook%E5%BC%B9%E7%AA%97%E5%8F%96%E6%B6%88.png" alt="hookå¼¹çª—å–æ¶ˆ"></p><pre><code>@Override // b.a.a.a.d.b.z
public void a(VersionBean.Version version, boolean z) {
    this.f1696a = version.url;
    if (version != null) {
        UpdateDialogFragment.b(version, z).show(getSupportFragmentManager(), UpdateDialogFragment.class.getSimpleName());
    }
}
</code></pre><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/smali%E6%BA%90%E7%A0%81.png" alt="smaliæºç "></p><h3 id="å»å£³"><a href="#å»å£³" class="headerlink" title="å»å£³"></a>å»å£³</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apktool -s d é’é’è‰è§†é¢‘.apk &amp;&amp; cd é’é’è‰è§†é¢‘&#x2F;   è§£åŒ…æŒ‡å®šä¸åç¼–è¯‘æºç å¹¶ä¿ç•™dexï¼Œå¹¶æ‰”æ‰å£³</span><br><span class="line">cp ~&#x2F;Desktop&#x2F;com.hello.qqc&#x2F;*.dex .  å°†ä¹‹å‰å»å£³åçš„dexæ”¾å…¥è§£åŒ…æ–‡ä»¶å¤¹</span><br><span class="line">thunar .  æ‰“å¼€æ‰€åœ¨æ–‡ä»¶å¤¹ï¼Œctrl+2ä»¥è¯¦ç»†ä¿¡æ¯æŸ¥çœ‹æ–‡ä»¶ï¼Œæ ¹æ®å¤§å°è¿›è¡Œé‡å‘½ådexï¼Œclasses.dex,classes2.dex...</span><br></pre></td></tr></table></figure><p><img src="/2021/02/09/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%8E%BB%E5%BC%B9%E7%AA%97%E9%87%8D%E6%89%93%E5%8C%85/%E9%87%8D%E5%91%BD%E5%90%8Ddex.png" alt="é‡å‘½ådex"></p><p>åœ¨jadxä¸­æœç´¢extends Application æ‰¾åˆ°ä¸»å…¥å£æ–‡ä»¶<code>cn.net.tokyo.ccg.base.App</code>,vim AndroidManifest.xml æœç´¢applicationæ ‡ç­¾ï¼Œä¿®æ”¹<code>android:name=&quot;com.SecShell.SecShell.ApplicationWrapper&quot;</code> ä¸º<code>android:name=&quot;cn.net.tokyo.ccg.base.App&quot;</code>ä¿®æ”¹åŠ å£³å…¥å£ç‚¹ä¸ºåŸappçš„å…¥å£ç‚¹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apktool b é’é’è‰è§†é¢‘    å›ç¼–è¯‘</span><br><span class="line">cd é’é’è‰è§†é¢‘&#x2F;dist    ç¼–è¯‘å®Œæˆçš„apk</span><br><span class="line">keytool -genkey -alias abc.keystore -keyalg RSA -validity 20000 -keystore abc.keystore</span><br><span class="line">jarsigner -verbose -keystore abc.keystore -signedjar qqc_signed.apk é’é’è‰è§†é¢‘.apk abc.keystore   ç­¾å</span><br><span class="line">adb install -r qqc_signed.apk  é‡æ–°å®‰è£…ç¼–è¯‘åçš„apkï¼Œå³è„±å£³åçš„é‡æ‰“åŒ…dex</span><br></pre></td></tr></table></figure><h3 id="å»å¼¹çª—-1"><a href="#å»å¼¹çª—-1" class="headerlink" title="å»å¼¹çª—"></a>å»å¼¹çª—</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">apktool d é’é’è‰è§†é¢‘.apk</span><br><span class="line">cd é’é’è‰è§†é¢‘&#x2F;</span><br><span class="line">tree -NCfhl | grep MainActivity</span><br><span class="line">vim .&#x2F;é’é’è‰è§†é¢‘&#x2F;smali&#x2F;cn&#x2F;net&#x2F;tokyo&#x2F;ccg&#x2F;ui&#x2F;activity&#x2F;MainActivity.smali  æœç´¢UpdateDialogFragment</span><br><span class="line">ä¿®æ”¹if-eqz p1, :cond_0ä¸ºif-nez p1, :cond_0</span><br><span class="line">apktool b é’é’è‰è§†é¢‘&#x2F;   å›ç¼–è¯‘</span><br><span class="line">cd é’é’è‰è§†é¢‘&#x2F;dist    ç¼–è¯‘å®Œæˆçš„apk</span><br><span class="line">keytool -genkey -alias abc.keystore -keyalg RSA -validity 20000 -keystore abc.keystore</span><br><span class="line">jarsigner -verbose -keystore abc.keystore -signedjar qqc2_signed.apk é’é’è‰è§†é¢‘.apk abc.keystore   é‡ç­¾å</span><br><span class="line">adb install -r qqc2_signed.apk  é‡æ–°å®‰è£…ç¼–è¯‘åçš„apk</span><br></pre></td></tr></table></figure></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if(!isMobile){var btw=new BTWPlugin;btw.init({id:"vip-container",blogId:"25827-1638538754631-918",name:"ä¸‡ç‰©çš†å¯é€†å‘",qrcode:"https://onejane.github.io/gzh.jpg",keyword:"å¯†ç "})}</script></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…:</span> <span class="post-copyright-info"><a href="mailto:undefined">J</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥:</span> <span class="post-copyright-info"><a href="http://onejane.github.io/2021/02/09/åŠ¨é™æ€åˆ†æä¹‹å»å¼¹çª—é‡æ‰“åŒ…/">http://onejane.github.io/2021/02/09/åŠ¨é™æ€åˆ†æä¹‹å»å¼¹çª—é‡æ‰“åŒ…/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜:</span> <span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://onejane.github.io">ä¸‡ç‰©çš†å¯é€†å‘</a>ï¼</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/frida/">frida</a><a class="post-meta__tags" href="/tags/objection/">objection</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="http://onejane.gitee.io/picture/alipay.png"><div class="post-qr-code__desc">æ”¯ä»˜å®æ‰“èµ</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="http://onejane.gitee.io/picture/wx.png"><div class="post-qr-code__desc">å¾®ä¿¡æ‰“èµ</div></div></div><div class="social-share pull-right" data-disabled="google,facebook"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2021/02/12/%E5%9F%BA%E4%BA%8E%E5%86%85%E5%AD%98%E6%BC%AB%E6%B8%B8%E5%AE%9A%E4%BD%8D%E5%88%86%E6%9E%90/"><i class="fa fa-chevron-left"></i> <span>åŸºäºå†…å­˜æ¼«æ¸¸å®šä½åˆ†æ</span></a></div><div class="next-post pull-right"><a href="/2021/02/05/%E5%8A%A8%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8B%E9%94%81%E6%9C%BA%E7%97%85%E6%AF%92/"><span>åŠ¨é™æ€åˆ†æä¹‹é”æœºç—…æ¯’</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="vcomment"></div><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify=!1,verify=!1,record_ip=!1,GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter(function(i){return-1<GUEST_INFO.indexOf(i)});guest_info=0==guest_info.length?GUEST_INFO:guest_info,window.valine=new Valine({el:"#vcomment",notify:notify,verify:verify,recordIP:record_ip,appId:"cWLsquGr5PNi33OWXNhzerep-gzGzoHsz",appKey:"S35phfCSbm8dAG9LpOc5rjm3",placeholder:"ä¸€èµ·æ¥å¹ç‰›é€¼å¥½å—ï¼",avatar:"mm",guest_info:guest_info,pageSize:"10",lang:"zh-cn"})</script></div></div><footer class="footer-bg" style="background-image:url(http://onejane.gitee.io/picture/kali.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2021 - 2022 By J</div><div class="framework-info"><span>é©±åŠ¨ -</span> <a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ -</span> <a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script src="/js/search/local-search.js"></script><script>/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)&&($("#nav").addClass("is-mobile"),$("footer").addClass("is-mobile"),$("#top-container").addClass("is-mobile"))</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« "></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>ç”±</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49b1f5">hexo-generator-search</a> <span>æä¾›æ”¯æŒ</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>