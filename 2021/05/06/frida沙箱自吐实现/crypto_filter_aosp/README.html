<h1 id="crypto-filter-aosp"><a href="#crypto-filter-aosp" class="headerlink" title="crypto_filter_aosp"></a>crypto_filter_aosp</h1><h1 id="监控java层的加密算法一个ROM"><a href="#监控java层的加密算法一个ROM" class="headerlink" title="监控java层的加密算法一个ROM"></a>监控java层的加密算法一个ROM</h1><p>基于android6.0.1 编译</p><p>下载地址:</p><p><a href="https://drive.google.com/file/d/19G5IXIiww_b5PcQqqiA6lTO6QvnMtQkS/view?usp=sharing" target="_blank" rel="noopener">https://drive.google.com/file/d/19G5IXIiww_b5PcQqqiA6lTO6QvnMtQkS/view?usp=sharing</a></p><p>/Volumes/SamsungT5/aosp6.0.1/libcore/luni/src/main/java/javax/crypto/MyUtil.java</p><p>/Volumes/SamsungT5/aosp6.0.1/libcore/luni/src/main/java/javax/crypto/Mac.java</p><p>/Volumes/SamsungT5/aosp6.0.1/libcore/luni/src/main/java/javax/crypto/Cipher.java</p><p>/Volumes/SamsungT5/aosp6.0.1/libcore/luni/src/main/java/java/security/MessageDigest.java</p><p>/Volumes/SamsungT5/aosp6.0.1/libcore/luni/src/main/java/javax/crypto/ContextHolder.java</p><p>/Volumes/SamsungT5/aosp6.0.1/libcore/luni/src/main/java/javax/crypto/AndroidBase64.java</p><p>适用手机型号Nexus 6P</p><p>使用办法:</p><p>1.手机先刷入twrp</p><p>2.下载rom解压，adb push ROM/ /sdcard/TWRP/BACKUPS</p><p>3.进入twrp，从备份中恢复,重启手机,然后修改权限 chmod 777 /data/local/tmp/monitor_package</p><p>4.安装你需要监控的apk(系统自动把最后一次安装的apk添加进去监控的列表 /data/local/tmp/monitor_package),只能同时监控一个</p><p>5./data/data/package_name/下面生成APK调用的算法,只有三种(数据均为JSON编码,字段为BASE64编码):</p><p> MessageDigest文件为HASH</p><p> Cipher文件为加密算法</p><p> Mac</p><h1 id="example"><a href="#example" class="headerlink" title="example"></a>example</h1><p> Cipher:</p><p> <code>CipherTag:{&quot;opmode&quot;:&quot;DECRYPT_MODE&quot;,&quot;key&quot;:&quot;rM+FMzVeI0VniavN7xISNKzPhTM1XiNF&quot;,&quot;Key(Base64)&quot;:&quot;rM+FMzVeI0VniavN7xISNKzPhTM1XiNF&quot;,&quot;algorithm&quot;:&quot;DESede&quot;,&quot;SecureRandom&quot;:&quot;SHA1PRNG&quot;,&quot;provider&quot;:&quot;&quot;,&quot;transformation&quot;:&quot;DESede\/ECB\/NoPadding&quot;,&quot;data&quot;:&quot;&quot;,&quot;Base64Data&quot;:&quot;&quot;,&quot;doFinal&quot;:&quot;&quot;,&quot;Base64Cipher&quot;:&quot;&quot;,&quot;StackTrace&quot;:&quot;ZGFsdmlrLnN5c3RlbS5WTVN0YWNrLmdldFRocmVhZFN0YWNrVHJhY2UoKSAtMiA8LSAKamF2YS5sYW5nLlRocmVhZC5nZXRTdGFja1RyYWNlKCkgNTgwIDwtIApqYXZheC5jcnlwdG8uQ2lwaGVyLmRvRmluYWwoKSAxLDc4NiA8LSAKY29tLmJhbmdjbGUuYW5kam5pLkpuaUxpYi5jTCgpIC0yIDwtIApjb20udW5pb25wYXkudGlua2VycGF0Y2gubGliLnVwdXRpbHMuRGVzVXRpbHMuaW50ZXJuYWxDcnlwdCgpIC0xIDwtIApjb20uYmFuZ2NsZS5hbmRqbmkuSm5pTGliLmNMKCkgLTIgPC0gCmNvbS51bmlvbnBheS50aW5rZXJwYXRjaC5saWIudXB1dGlscy5EZXNVdGlscy5lY2JEZWNyeXB0KCkgLTEgPC0gCmNvbS5iYW5nY2xlLmFuZGpuaS5KbmlMaWIuY0woKSAtMiA8LSAKY29tLnVuaW9ucGF5LnRpbmtlcnBhdGNoLmxpYi51cHV0aWxzLlByZWZlcmVuY2VVdGlscy5kZWNQcmVmRGF0YSgpIC0xIDwtIApjb20uYmFuZ2NsZS5hbmRqbmkuSm5pTGliLmNMKCkgLTIgPC0gCmNvbS51bmlvbnBheS50aW5rZXJwYXRjaC5saWIudXB1dGlscy5QcmVmZXJlbmNlVXRpbHMuZGVjcnlwdERhdGEoKSAtMSA8LSAKY29tLmJhbmdjbGUuYW5kam5pLkpuaUxpYi5jTCgpIC0yIDwtIApjb20udW5pb25wYXkudGlua2VycGF0Y2gubGliLnVwdXRpbHMuUHJlZmVyZW5jZVV0aWxzLmdldEluZm9tYXRpb24oKSAtMSA8LSAKY29tLnVuaW9ucGF5LnRpbmtlcnBhdGNoLmxpYi51cHV0aWxzLlByZWZlcmVuY2VVdGlscy5nZXRVaWRJbmZvbWF0aW9uKCkgNjMgPC0gCmNvbS51bmlvbnBheS50aW5rZXJwYXRjaC5saWIudXB1dGlscy5EZXZpY2VJbmZvVXRpbC5nZXRVRElEKCkgNjE2IDwtIApjb20uYmFuZ2NsZS5hbmRqbmkuSm5pTGliLmNMKCkgLTIgPC0gCmNvbS51bmlvbnBheS50aW5rZXJwYXRjaC5saWIuc2VydmVyLm1vZGVsLkRldmljZUluZm8uaW5pdERldmljZUluZm8oKSAtMSA8LSAKY29tLnVuaW9ucGF5LnRpbmtlcnBhdGNoLmxpYi5zZXJ2ZXIudXRpbHMuVmVyc2lvblV0aWxzLjxpbml0PigpIDUyIDwtIApjb20udW5pb25wYXkudGlua2VycGF0Y2gubGliLnNlcnZlci5jbGllbnQuVGlua2VyQ2xpZW50QVBJLmluaXQoKSAxNDAgPC0gCmNvbS51bmlvbnBheS50aW5rZXJwYXRjaC5saWIuc2VydmVyLnJlcG9ydGVyLlJlcG9ydFV0aWxzLjxpbml0PigpIDM5IDwtIApjb20udW5pb25wYXkudGlua2VycGF0Y2gubGliLnNlcnZlci5yZXBvcnRlci5SZXBvcnRVdGlscy5pbml0KCkgMjMgPC0gCmNvbS5iYW5nY2xlLmFuZGpuaS5KbmlMaWIuY1YoKSAtMiA8LSAKY29tLnVuaW9ucGF5LnRpbmtlcnBhdGNoLmxpYi50cHJlcG9ydGVyLlRpbmtlck1hbmFnZXIuaW5zdGFsbFRpbmtlcigpIC0xIDwtIApjb20udW5pb25wYXkudGlua2VycGF0Y2gubGliLlRpbmtlclBhdGNoLmluaXQoKSA4MiA8LSAKY29tLnVuaW9ucGF5LmJhc2UuVVBBcHBsaWNhdGlvbkxpa2UuY2hlY2tIb3RQYXRjaCgpIDMwMiA8LSAKY29tLnVuaW9ucGF5LmJhc2UuVVBBcHBsaWNhdGlvbkxpa2Uub25DcmVhdGUoKSAxMDkgPC0gCmphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZC5pbnZva2UoKSAtMiA8LSAKY29tLnRlbmNlbnQudGlua2VyLmxvYWRlci5hcHAuVGlua2VyQXBwbGljYXRpb24uaW52b2tlQXBwTGlrZU9uQ3JlYXRlKCkgMTg5IDwtIApjb20udGVuY2VudC50aW5rZXIubG9hZGVyLmFwcC5UaW5rZXJBcHBsaWNhdGlvbi5vbkNyZWF0ZSgpIDIwNSA8LSAKYW5kcm9pZC5hcHAuSW5zdHJ1bWVudGF0aW9uLmNhbGxBcHBsaWNhdGlvbk9uQ3JlYXRlKCkgMSwwMTMgPC0gCmFuZHJvaWQuYXBwLkFjdGl2aXR5VGhyZWFkLmhhbmRsZUJpbmRBcHBsaWNhdGlvbigpIDQsNzEyIDwtIApkZS5yb2J2LmFuZHJvaWQueHBvc2VkLlhwb3NlZEJyaWRnZS5pbnZva2VPcmlnaW5hbE1ldGhvZE5hdGl2ZSgpIC0yIDwtIApkZS5yb2J2LmFuZHJvaWQueHBvc2VkLlhwb3NlZEJyaWRnZS5oYW5kbGVIb29rZWRNZXRob2QoKSAzNjAgPC0gCmFuZHJvaWQuYXBwLkFjdGl2aXR5VGhyZWFkLmhhbmRsZUJpbmRBcHBsaWNhdGlvbigpIC0xIDwtIAphbmRyb2lkLmFwcC5BY3Rpdml0eVRocmVhZC4td3JhcDEoKSAtMSA8LSAKYW5kcm9pZC5hcHAuQWN0aXZpdHlUaHJlYWQkSC5oYW5kbGVNZXNzYWdlKCkgMSw0MDUgPC0gCmFuZHJvaWQub3MuSGFuZGxlci5kaXNwYXRjaE1lc3NhZ2UoKSAxMDIgPC0gCmFuZHJvaWQub3MuTG9vcGVyLmxvb3AoKSAxNDggPC0gCmFuZHJvaWQuYXBwLkFjdGl2aXR5VGhyZWFkLm1haW4oKSA1LDQyMiA8LSAKamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kLmludm9rZSgpIC0yIDwtIApjb20uYW5kcm9pZC5pbnRlcm5hbC5vcy5aeWdvdGVJbml0JE1ldGhvZEFuZEFyZ3NDYWxsZXIucnVuKCkgNzI2IDwtIApjb20uYW5kcm9pZC5pbnRlcm5hbC5vcy5aeWdvdGVJbml0Lm1haW4oKSA2MTYgPC0gCmRlLnJvYnYuYW5kcm9pZC54cG9zZWQuWHBvc2VkQnJpZGdlLm1haW4oKSAxMDc=&quot;}</code></p><p> MessageDigest:</p><p> <code>MessageDigestTag:{&quot;Algorithm&quot;:&quot;SHA-256&quot;,&quot;Provider&quot;:&quot;AndroidOpenSSL&quot;,&quot;data&quot;:&quot;staffId&quot;,&quot;Base64Data&quot;:&quot;c3RhZmZJZA==&quot;,&quot;digest&quot;:&quot;e8f3205321cb6c5a1fcb5ce7a712724707c0cb8d155ed486427a10f368d81910&quot;,&quot;StackTrace&quot;:&quot;ZGFsdmlrLnN5c3RlbS5WTVN0YWNrLmdldFRocmVhZFN0YWNrVHJhY2UoKSAtMiA8LSAKamF2YS5sYW5nLlRocmVhZC5nZXRTdGFja1RyYWNlKCkgNTgwIDwtIApqYXZhLnNlY3VyaXR5Lk1lc3NhZ2VEaWdlc3QuZGlnZXN0KCkgNDc2IDwtIApjb20uYXNpYWluZm8ueGoubGliLnV0aWxzLnkuPGluaXQ+KCkgOCA8LSAKY29tLmFzaWFpbmZvLnhqLmxpYi51dGlscy55LmEoKSAyMzkgPC0gCmNvbS5hc2lhaW5mby54ai5saWIuYy5iLmEoKSAxNSA8LSAKY29tLmFzaWFpbmZvLnhqLmxpYi5jLmIuYSgpIDMwIDwtIApjb20uYXNpYWluZm8ucWRsbS5iLmEuYSgpIDEgPC0gCmNvbS5hc2lhaW5mby5xZGxtLmIuYS5hKCkgNDI4IDwtIApjb20uYXNpYWluZm8ucWRsbS51aS5zcGxhc2guTGF1bmNoZXJBY3Rpdml0eS5pKCkgMSA8LSAKY29tLmFzaWFpbmZvLnFkbG0udWkuc3BsYXNoLkxhdW5jaGVyQWN0aXZpdHkuaigpIDMgPC0gCmNvbS5hc2lhaW5mby5xZGxtLnVpLnNwbGFzaC5MYXVuY2hlckFjdGl2aXR5Lm9uQ3JlYXRlKCkgOSA8LSAKYW5kcm9pZC5hcHAuQWN0aXZpdHkucGVyZm9ybUNyZWF0ZSgpIDYsMjUxIDwtIAphbmRyb2lkLmFwcC5JbnN0cnVtZW50YXRpb24uY2FsbEFjdGl2aXR5T25DcmVhdGUoKSAxLDEwNyA8LSAKYW5kcm9pZC5hcHAuQWN0aXZpdHlUaHJlYWQucGVyZm9ybUxhdW5jaEFjdGl2aXR5KCkgMiwzNjkgPC0gCmFuZHJvaWQuYXBwLkFjdGl2aXR5VGhyZWFkLmhhbmRsZUxhdW5jaEFjdGl2aXR5KCkgMiw0NzYgPC0gCmFuZHJvaWQuYXBwLkFjdGl2aXR5VGhyZWFkLi13cmFwMTEoKSAtMSA8LSAKYW5kcm9pZC5hcHAuQWN0aXZpdHlUaHJlYWQkSC5oYW5kbGVNZXNzYWdlKCkgMSwzNDQgPC0gCmFuZHJvaWQub3MuSGFuZGxlci5kaXNwYXRjaE1lc3NhZ2UoKSAxMDIgPC0gCmFuZHJvaWQub3MuTG9vcGVyLmxvb3AoKSAxNDggPC0gCmFuZHJvaWQuYXBwLkFjdGl2aXR5VGhyZWFkLm1haW4oKSA1LDQyMiA8LSAKamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kLmludm9rZSgpIC0yIDwtIApjb20uYW5kcm9pZC5pbnRlcm5hbC5vcy5aeWdvdGVJbml0JE1ldGhvZEFuZEFyZ3NDYWxsZXIucnVuKCkgNzI2IDwtIApjb20uYW5kcm9pZC5pbnRlcm5hbC5vcy5aeWdvdGVJbml0Lm1haW4oKSA2MTYgPC0gCmRlLnJvYnYuYW5kcm9pZC54cG9zZWQuWHBvc2VkQnJpZGdlLm1haW4oKSAxMDc=&quot;} MessageDigestTag:{&quot;Algorithm&quot;:&quot;MD5&quot;,&quot;Provider&quot;:&quot;AndroidOpenSSL&quot;,&quot;data&quot;:&quot;ns@3&#39;*DHF7\/==&quot;,&quot;Base64Data&quot;:&quot;bnNAMycqREhGNy89PQ==&quot;,&quot;digest&quot;:&quot;31fb6fd3d44c84fb2df62958a7da31f6&quot;,&quot;StackTrace&quot;:&quot;ZGFsdmlrLnN5c3RlbS5WTVN0YWNrLmdldFRocmVhZFN0YWNrVHJhY2UoKSAtMiA8LSAKamF2YS5sYW5nLlRocmVhZC5nZXRTdGFja1RyYWNlKCkgNTgwIDwtIApqYXZhLnNlY3VyaXR5Lk1lc3NhZ2VEaWdlc3QuZGlnZXN0KCkgNDc2IDwtIApqYXZhLnNlY3VyaXR5Lk1lc3NhZ2VEaWdlc3QuZGlnZXN0KCkgNjAxIDwtIApjb20uYXNpYWluZm8ueGoubGliLnV0aWxzLnUuYigpIDQgPC0gCmNvbS5hc2lhaW5mby54ai5saWIudXRpbHMudS5hKCkgMTUgPC0gCmNvbS5hc2lhaW5mby54ai5saWIuYy5iLmEoKSAxNyA8LSAKY29tLmFzaWFpbmZvLnhqLmxpYi5jLmIuYSgpIDMwIDwtIApjb20uYXNpYWluZm8ucWRsbS5iLmEuYSgpIDEgPC0gCmNvbS5hc2lhaW5mby5xZGxtLmIuYS5hKCkgNDI4IDwtIApjb20uYXNpYWluZm8ucWRsbS51aS5zcGxhc2guTGF1bmNoZXJBY3Rpdml0eS5pKCkgMSA8LSAKY29tLmFzaWFpbmZvLnFkbG0udWkuc3BsYXNoLkxhdW5jaGVyQWN0aXZpdHkuaigpIDMgPC0gCmNvbS5hc2lhaW5mby5xZGxtLnVpLnNwbGFzaC5MYXVuY2hlckFjdGl2aXR5Lm9uQ3JlYXRlKCkgOSA8LSAKYW5kcm9pZC5hcHAuQWN0aXZpdHkucGVyZm9ybUNyZWF0ZSgpIDYsMjUxIDwtIAphbmRyb2lkLmFwcC5JbnN0cnVtZW50YXRpb24uY2FsbEFjdGl2aXR5T25DcmVhdGUoKSAxLDEwNyA8LSAKYW5kcm9pZC5hcHAuQWN0aXZpdHlUaHJlYWQucGVyZm9ybUxhdW5jaEFjdGl2aXR5KCkgMiwzNjkgPC0gCmFuZHJvaWQuYXBwLkFjdGl2aXR5VGhyZWFkLmhhbmRsZUxhdW5jaEFjdGl2aXR5KCkgMiw0NzYgPC0gCmFuZHJvaWQuYXBwLkFjdGl2aXR5VGhyZWFkLi13cmFwMTEoKSAtMSA8LSAKYW5kcm9pZC5hcHAuQWN0aXZpdHlUaHJlYWQkSC5oYW5kbGVNZXNzYWdlKCkgMSwzNDQgPC0gCmFuZHJvaWQub3MuSGFuZGxlci5kaXNwYXRjaE1lc3NhZ2UoKSAxMDIgPC0gCmFuZHJvaWQub3MuTG9vcGVyLmxvb3AoKSAxNDggPC0gCmFuZHJvaWQuYXBwLkFjdGl2aXR5VGhyZWFkLm1haW4oKSA1LDQyMiA8LSAKamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kLmludm9rZSgpIC0yIDwtIApjb20uYW5kcm9pZC5pbnRlcm5hbC5vcy5aeWdvdGVJbml0JE1ldGhvZEFuZEFyZ3NDYWxsZXIucnVuKCkgNzI2IDwtIApjb20uYW5kcm9pZC5pbnRlcm5hbC5vcy5aeWdvdGVJbml0Lm1haW4oKSA2MTYgPC0gCmRlLnJvYnYuYW5kcm9pZC54cG9zZWQuWHBvc2VkQnJpZGdlLm1haW4oKSAxMDc=&quot;}</code></p>