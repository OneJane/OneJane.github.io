<h1 id="r0capture"><a href="#r0capture" class="headerlink" title="r0capture"></a>r0capture</h1><p>安卓应用层抓包通杀脚本</p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ul><li>仅限安卓平台，测试安卓7、8、9、10 可用 ；</li><li>无视所有证书校验或绑定，不用考虑任何证书的事情；</li><li>通杀TCP/IP四层模型中的应用层中的全部协议；</li><li>通杀协议包括：Http,WebSocket,Ftp,Xmpp,Imap,Smtp,Protobuf等等、以及它们的SSL版本；</li><li>通杀所有应用层框架，包括HttpUrlConnection、Okhttp1/3/4、Retrofit/Volley等等；</li><li>如果有抓不到的情况欢迎提issue，或者直接加vx：r0ysue，进行反馈~</li></ul><h2 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h2><ul><li>Spawn 模式：</li></ul><p><code>$ python3 r0capture.py -U -f com.qiyi.video</code></p><ul><li>Attach 模式，抓包内容保存成pcap文件供后续分析：</li></ul><p><code>$ python3 r0capture.py -U com.qiyi.video -p iqiyi.pcap</code></p><p>建议使用<code>Attach</code>模式，从感兴趣的地方开始抓包，并且保存成<code>pcap</code>文件，供后续使用Wireshark进行分析。</p><p><img src="Sample.PNG"></p><p>PS：</p><blockquote><p>这个项目基于<a href="https://github.com/BigFaceCat2017/frida_ssl_logger" target="_blank" rel="noopener">frida_ssl_logger</a>，之所以换个名字，只是侧重点不同。</p></blockquote><blockquote><p>原项目的侧重点在于抓ssl和跨平台，本项目的侧重点是抓到所有的包。</p></blockquote><h2 id="以下是原项目的简介："><a href="#以下是原项目的简介：" class="headerlink" title="以下是原项目的简介："></a>以下是原项目的简介：</h2><p><a href="https://github.com/BigFaceCat2017/frida_ssl_logger" target="_blank" rel="noopener">https://github.com/BigFaceCat2017/frida_ssl_logger</a></p><h3 id="frida-ssl-logger"><a href="#frida-ssl-logger" class="headerlink" title="frida_ssl_logger"></a>frida_ssl_logger</h3><p>ssl_logger based on frida<br>for from <a href="https://github.com/google/ssl_logger" target="_blank" rel="noopener">https://github.com/google/ssl_logger</a></p><h3 id="修改内容"><a href="#修改内容" class="headerlink" title="修改内容"></a>修改内容</h3><ol><li>优化了frida的JS脚本，修复了在新版frida上的语法错误；</li><li>调整JS脚本，使其适配iOS和macOS，同时也兼容了Android；</li><li>增加了更多的选项，使其能在多种情况下使用；</li></ol><h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><pre><code class="shell">  python3 ./ssl_logger.py  -U -f com.bfc.mm
  python3 ./ssl_logger.py -v  -p test.pcap  6666
</code></pre>